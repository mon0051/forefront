{"version":3,"sources":["async_pipe.js"],"names":[],"mappings":"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","file":"async_pipe-compiled.js","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport { ChangeDetectorRef, Pipe, WrappedValue } from '@angular/core';\nimport { ObservableWrapper } from '../facade/async';\nimport { isBlank, isPresent, isPromise } from '../facade/lang';\nimport { InvalidPipeArgumentException } from './invalid_pipe_argument_exception';\nclass ObservableStrategy {\n    createSubscription(async, updateLatestValue) {\n        return ObservableWrapper.subscribe(async, updateLatestValue, e => { throw e; });\n    }\n    dispose(subscription) { ObservableWrapper.dispose(subscription); }\n    onDestroy(subscription) { ObservableWrapper.dispose(subscription); }\n}\nclass PromiseStrategy {\n    createSubscription(async, updateLatestValue) {\n        return async.then(updateLatestValue, e => { throw e; });\n    }\n    dispose(subscription) { }\n    onDestroy(subscription) { }\n}\nvar _promiseStrategy = new PromiseStrategy();\nvar _observableStrategy = new ObservableStrategy();\nvar __unused;\nexport class AsyncPipe {\n    constructor(_ref) {\n        /** @internal */\n        this._latestValue = null;\n        /** @internal */\n        this._latestReturnedValue = null;\n        /** @internal */\n        this._subscription = null;\n        /** @internal */\n        this._obj = null;\n        this._strategy = null;\n        this._ref = _ref;\n    }\n    ngOnDestroy() {\n        if (isPresent(this._subscription)) {\n            this._dispose();\n        }\n    }\n    transform(obj) {\n        if (isBlank(this._obj)) {\n            if (isPresent(obj)) {\n                this._subscribe(obj);\n            }\n            this._latestReturnedValue = this._latestValue;\n            return this._latestValue;\n        }\n        if (obj !== this._obj) {\n            this._dispose();\n            return this.transform(obj);\n        }\n        if (this._latestValue === this._latestReturnedValue) {\n            return this._latestReturnedValue;\n        }\n        else {\n            this._latestReturnedValue = this._latestValue;\n            return WrappedValue.wrap(this._latestValue);\n        }\n    }\n    /** @internal */\n    _subscribe(obj) {\n        this._obj = obj;\n        this._strategy = this._selectStrategy(obj);\n        this._subscription = this._strategy.createSubscription(obj, (value) => this._updateLatestValue(obj, value));\n    }\n    /** @internal */\n    _selectStrategy(obj) {\n        if (isPromise(obj)) {\n            return _promiseStrategy;\n        }\n        else if (ObservableWrapper.isObservable(obj)) {\n            return _observableStrategy;\n        }\n        else {\n            throw new InvalidPipeArgumentException(AsyncPipe, obj);\n        }\n    }\n    /** @internal */\n    _dispose() {\n        this._strategy.dispose(this._subscription);\n        this._latestValue = null;\n        this._latestReturnedValue = null;\n        this._subscription = null;\n        this._obj = null;\n    }\n    /** @internal */\n    _updateLatestValue(async, value) {\n        if (async === this._obj) {\n            this._latestValue = value;\n            this._ref.markForCheck();\n        }\n    }\n}\n/** @nocollapse */\nAsyncPipe.decorators = [\n    { type: Pipe, args: [{ name: 'async', pure: false },] },\n];\n/** @nocollapse */\nAsyncPipe.ctorParameters = [\n    { type: ChangeDetectorRef, },\n];\n//# sourceMappingURL=async_pipe.js.map"]}